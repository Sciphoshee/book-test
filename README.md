# Книжный каталог

## Тестовое задание по созданию книжного сервиса

Необходимо создать сайт с указанным функционалом:

```
Необходимо сделать на фреймворке Yii2 + MySQL каталог книг. Книга может иметь несколько авторов.

1. Книга - название, год выпуска, описание, isbn, фото главной страницы.
2. Авторы - ФИО.

Права на доступ:
1. Гость - только просмотр + подписка на новые книги автора.
2. Юзер - просмотр, добавление, редактирование, удаление.

Отчет - ТОП 10 авторов выпуствиших больше книг за какой-то год.

ПЛЮСОМ БУДЕТ
Уведомление о поступлении книг из подписки должно отправляться на смс гостю.

https://smspilot.ru/
там "Для тестирования можно использовать ключ эмулятор (реальной отправки SMS не происходит)."


Ответы на часто задаваемые вопросы/пожелания к выполнению:

    1) Нужно сделать web приложение? не API? – web

    2) Нужна авторизация? – да

    3) Если нужно web приложение, откуда брать верстку? - сверстать самому, обычный bootstrap подойдет

    4) Отчет нужен как PDF? или как отдельная страница? Если отдельная страница или PDF, то кто имеет право ее видеть? - отдельная страница, доступ для всех

    5) Нужен функционал администратора, который может управлять подпиской/отпиской? – не нужен

    6) Как осуществляется отписка от новых поступлений? – это не требуется

    7) По тестовому заданию нужна БД MySQL. Можно прислать в виде файлов, но без директорий runtime и vendor. Дамп БД не нужен, нужны миграции.
```

## Установка и настройка

### 1. Проект

> После запуска будет доступен по адресу:\
> `http://book.localhost/`

* Создаем папку и заходим в нее

```
cd /var/www && mkdir book && cd book
```

* Забираем себе код проекта
```
git clone git@github.com:Sciphoshee/book-test.git ./
```

* Копируем файл с переменными окружения
```
cp .env.example .env
```

* Собираем проект
```
docker-compose build
```

* Разворачивание проекта выполняется
```
docker-compose up -d
```

* Установка зависимостей (контейнер ***app***)
```
docker-compose exec app bash
composer install
```

* Инициализируем фреймворк (для dev окружения)
```
php init
```

* Запускаем миграции
```
php yii/migrate
```

## 2. БД


БД можно управлять через adminer\
  [http://127.0.0.1:8080/?server=db&username=db_user&db=book](http://127.0.0.1:8080/?server=db&username=db_user&db=book)



### WSL

* Если выходит ошибка про порты

> Ports are not available: exposing port TCP 0.0.0.0:3381 -> 0.0.0.0:0: listen tcp 0.0.0.0:3381: bind: An attempt was made to access a socket in a way forbidden by its access permissions

https://superuser.com/questions/1604199/find-who-excluded-port-range

В обычной консоли Windows с правами администратора:

```bash
net stop winnat
```
